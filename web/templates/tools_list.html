{% extends "base.html" %}
<!--
Copyright All rights Reserved 2025-2030, Ashutosh Sinha, Email: ajsinha@gmail.com
-->
{% block title %}Tools - SAJHA MCP Server{% endblock %}

{% block content %}
<div class="container-fluid">
    <h1 class="h3 mb-4">
        <i class="bi bi-tools"></i> Available Tools
    </h1>
    
    <div class="card">
        <div class="card-body">
            {% if tools %}
            <div class="table-responsive">
                <table class="table table-striped table-hover" id="toolsListTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Parameters</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for tool in tools %}
                        <tr>
                            <td>
                                <strong>{{ tool.name }}</strong>
                            </td>
                            <td>{{ tool.description }}</td>
                            <td>
                                {% if tool.inputSchema and tool.inputSchema.required %}
                                <span class="badge bg-info">{{ tool.inputSchema.required|length }} required</span>
                                {% endif %}
                                {% if tool.inputSchema and tool.inputSchema.properties %}
                                <span class="badge bg-secondary">{{ tool.inputSchema.properties|length }} total</span>
                                {% else %}
                                <span class="badge bg-light text-dark">No parameters</span>
                                {% endif %}
                            </td>
                            <td>
                                <div class="btn-group" role="group">
                                    <a href="{{ url_for('tool_execute', tool_name=tool.name) }}" 
                                       class="btn btn-sm btn-success">
                                        <i class="bi bi-play-circle"></i> Execute
                                    </a>
                                    <button class="btn btn-sm btn-info" 
                                            onclick='viewDetails({{ tool|tojson }})'>
                                        <i class="bi bi-info-circle"></i> Details
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="alert alert-warning">
                <i class="bi bi-exclamation-triangle"></i> No tools available or you don't have access to any tools.
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Tool Details (shown in separate page, not modal) -->
<div id="toolDetails" style="display: none;"></div>

{% endblock %}

{% block extra_js %}
<script>
function viewDetails(tool) {
    // Create a new page with tool details
    const detailsWindow = window.open('', '_blank', 'width=800,height=600');
    detailsWindow.document.write(`
        <html>
        <head>
            <title>Tool Details: ${tool.name}</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        </head>
        <body>
            <div class="container mt-4">
                <h2>Tool Details: ${tool.name}</h2>
                <hr>
                <h4>Description</h4>
                <p>${tool.description}</p>
                <h4>Input Schema</h4>
                <pre class="bg-light p-3">${JSON.stringify(tool.inputSchema, null, 2)}</pre>
                <button class="btn btn-secondary" onclick="window.close()">Close</button>
            </div>
        </body>
        </html>
    `);
}

// Initialize DataTable
$(document).ready(function() {
    $('#toolsListTable').DataTable({
        "pageLength": 25,
        "order": [[0, "asc"]]
    });
});
</script>
{% endblock %}
