{
    "name": "duckdb_sql",
    "description": "Execute SQL queries directly on CSV data files. Available tables: customers (50 rows), orders (80 rows), products (27 rows). Use standard SQL syntax.",
    "category": "Data Analytics",
    "version": "2.9.8",
    "enabled": true,
    "implementation": "sajha.tools.impl.duckdb_olap_advanced.DuckDBSQLTool",
    "data_directory": "${data.duckdb.dir}",
    "inputSchema": {
        "type": "object",
        "properties": {
            "sql": {
                "type": "string",
                "description": "SQL query to execute. Use table names: customers, orders, products",
                "minLength": 1
            },
            "limit": {
                "type": "integer",
                "description": "Maximum rows to return",
                "minimum": 1,
                "maximum": 1000,
                "default": 100
            }
        },
        "required": ["sql"]
    },
    "outputSchema": {
        "type": "object",
        "properties": {
            "success": {"type": "boolean"},
            "columns": {"type": "array", "items": {"type": "string"}},
            "data": {"type": "array", "items": {"type": "object"}},
            "row_count": {"type": "integer"},
            "sql": {"type": "string"},
            "execution_time_ms": {"type": "number"}
        }
    },
    "metadata": {
        "author": "Ashutosh Sinha",
        "tags": ["duckdb", "sql", "query", "analytics"],
        "schema_info": {
            "customers": "customer_id, customer_name, email, country, region, city, customer_segment, customer_tier, signup_date, age_group, gender, acquisition_channel, is_active",
            "orders": "order_id, customer_id, order_date, product_category, product_name, quantity, unit_price, discount_pct, shipping_cost, payment_method, order_status, region, sales_rep",
            "products": "product_id, product_name, product_category, unit_cost, unit_price, supplier, stock_quantity, reorder_point"
        },
        "examples": [
            {
                "description": "Show all customers",
                "input": {"sql": "SELECT * FROM customers LIMIT 10"}
            },
            {
                "description": "Count customers by segment",
                "input": {"sql": "SELECT customer_segment, COUNT(*) as count FROM customers GROUP BY customer_segment ORDER BY count DESC"}
            },
            {
                "description": "Total revenue by region",
                "input": {"sql": "SELECT region, ROUND(SUM(quantity * unit_price * (1 - discount_pct/100.0)), 2) as revenue FROM orders GROUP BY region ORDER BY revenue DESC"}
            },
            {
                "description": "Top 10 customers by spend",
                "input": {"sql": "SELECT c.customer_name, c.customer_tier, ROUND(SUM(o.quantity * o.unit_price), 2) as total_spent FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.customer_name, c.customer_tier ORDER BY total_spent DESC LIMIT 10"}
            },
            {
                "description": "Product sales summary",
                "input": {"sql": "SELECT product_category, COUNT(*) as orders, SUM(quantity) as units_sold, ROUND(SUM(quantity * unit_price), 2) as revenue FROM orders GROUP BY product_category ORDER BY revenue DESC"}
            },
            {
                "description": "Monthly sales trend",
                "input": {"sql": "SELECT strftime('%Y-%m', order_date) as month, COUNT(*) as orders, ROUND(SUM(quantity * unit_price), 2) as revenue FROM orders GROUP BY month ORDER BY month"}
            }
        ]
    }
}
